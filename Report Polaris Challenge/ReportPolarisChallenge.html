<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=dpiI8CyVsrzWsJLBFKehGpLhv3qFjX7dUn1mYxfCXhI);ol.lst-kix_q2kphveqv25l-4.start{counter-reset:lst-ctn-kix_q2kphveqv25l-4 0}.lst-kix_q2kphveqv25l-2>li{counter-increment:lst-ctn-kix_q2kphveqv25l-2}.lst-kix_q2kphveqv25l-0>li:before{content:"" counter(lst-ctn-kix_q2kphveqv25l-0,lower-latin) ") "}.lst-kix_q2kphveqv25l-5>li{counter-increment:lst-ctn-kix_q2kphveqv25l-5}.lst-kix_q2kphveqv25l-2>li:before{content:"" counter(lst-ctn-kix_q2kphveqv25l-2,decimal) ") "}ol.lst-kix_q2kphveqv25l-4{list-style-type:none}ol.lst-kix_q2kphveqv25l-5{list-style-type:none}ol.lst-kix_q2kphveqv25l-6{list-style-type:none}ol.lst-kix_q2kphveqv25l-7{list-style-type:none}ol.lst-kix_q2kphveqv25l-8{list-style-type:none}.lst-kix_q2kphveqv25l-1>li:before{content:"" counter(lst-ctn-kix_q2kphveqv25l-1,lower-roman) ") "}ol.lst-kix_q2kphveqv25l-1.start{counter-reset:lst-ctn-kix_q2kphveqv25l-1 0}.lst-kix_q2kphveqv25l-6>li:before{content:"" counter(lst-ctn-kix_q2kphveqv25l-6,lower-latin) ". "}.lst-kix_q2kphveqv25l-4>li{counter-increment:lst-ctn-kix_q2kphveqv25l-4}ol.lst-kix_q2kphveqv25l-0{list-style-type:none}.lst-kix_q2kphveqv25l-1>li{counter-increment:lst-ctn-kix_q2kphveqv25l-1}.lst-kix_q2kphveqv25l-4>li:before{content:"(" counter(lst-ctn-kix_q2kphveqv25l-4,lower-roman) ") "}.lst-kix_q2kphveqv25l-8>li:before{content:"" counter(lst-ctn-kix_q2kphveqv25l-8,decimal) ". "}ol.lst-kix_q2kphveqv25l-1{list-style-type:none}ol.lst-kix_q2kphveqv25l-8.start{counter-reset:lst-ctn-kix_q2kphveqv25l-8 0}ol.lst-kix_q2kphveqv25l-2{list-style-type:none}.lst-kix_q2kphveqv25l-3>li:before{content:"(" counter(lst-ctn-kix_q2kphveqv25l-3,lower-latin) ") "}ol.lst-kix_q2kphveqv25l-6.start{counter-reset:lst-ctn-kix_q2kphveqv25l-6 0}.lst-kix_q2kphveqv25l-7>li:before{content:"" counter(lst-ctn-kix_q2kphveqv25l-7,lower-roman) ". "}ol.lst-kix_q2kphveqv25l-3{list-style-type:none}.lst-kix_q2kphveqv25l-8>li{counter-increment:lst-ctn-kix_q2kphveqv25l-8}ol.lst-kix_q2kphveqv25l-3.start{counter-reset:lst-ctn-kix_q2kphveqv25l-3 0}.lst-kix_q2kphveqv25l-5>li:before{content:"(" counter(lst-ctn-kix_q2kphveqv25l-5,decimal) ") "}ol.lst-kix_q2kphveqv25l-0.start{counter-reset:lst-ctn-kix_q2kphveqv25l-0 0}ol.lst-kix_q2kphveqv25l-5.start{counter-reset:lst-ctn-kix_q2kphveqv25l-5 0}ol.lst-kix_q2kphveqv25l-7.start{counter-reset:lst-ctn-kix_q2kphveqv25l-7 0}.lst-kix_q2kphveqv25l-7>li{counter-increment:lst-ctn-kix_q2kphveqv25l-7}ol.lst-kix_q2kphveqv25l-2.start{counter-reset:lst-ctn-kix_q2kphveqv25l-2 0}.lst-kix_q2kphveqv25l-3>li{counter-increment:lst-ctn-kix_q2kphveqv25l-3}.lst-kix_q2kphveqv25l-6>li{counter-increment:lst-ctn-kix_q2kphveqv25l-6}.lst-kix_q2kphveqv25l-0>li{counter-increment:lst-ctn-kix_q2kphveqv25l-0}ol{margin:0;padding:0}table td,table th{padding:0}.c1{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:93.6pt;border-top-color:#000000;border-bottom-style:solid}.c22{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Arial";font-style:normal}.c12{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c4{color:#424242;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Roboto";font-style:normal}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Roboto";font-style:normal}.c7{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Roboto";font-style:normal}.c13{background-color:#ffffff;text-decoration-skip-ink:none;font-size:12pt;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c6{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c21{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c15{padding-top:20pt;padding-bottom:6pt;line-height:1.0;page-break-after:avoid;text-align:center}.c3{padding-top:18pt;padding-bottom:6pt;line-height:1.0;page-break-after:avoid;text-align:justify}.c2{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:justify}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c20{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:center}.c19{border-spacing:0;border-collapse:collapse;margin-right:auto}.c18{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c16{background-color:#ffffff;color:#24292f;font-size:12pt}.c9{font-weight:700;font-family:"Roboto"}.c10{font-size:10pt;color:#424242}.c14{font-weight:400;font-family:"Roboto"}.c17{color:inherit;text-decoration:inherit}.c11{height:11pt}.c8{height:0pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c18 doc-content"><h1 class="c15" id="h.a97n451p7mn"><span class="c16">&nbsp;</span><span class="c13"><a class="c17" href="https://www.google.com/url?q=https://polarishub.io/blog/antiviral-competition&amp;sa=D&amp;source=editors&amp;ust=1742229534372730&amp;usg=AOvVaw0kbgFOeGzsoRtDTFncDPFF">ASAP Discovery x OpenADMET challenge</a></span><span class="c22">&nbsp;- Ligand Potency</span></h1><p class="c20 c11"><span class="c0"></span></p><p class="c11 c20"><span class="c0"></span></p><p class="c2"><span class="c0">In this blind drug discovery challenge, the objective is to predict the binding affinity of small molecule ligands to the two coronavirus main proteases of SARS-CoV-2 and MERS-CoV.</span></p><h2 class="c3" id="h.z9v6vipck9du"><span class="c12">Model setup</span></h2><p class="c2"><span class="c0">We used our pre-trained protein-ligand activity foundational model to tackle this challenge.</span></p><p class="c2"><span class="c0">Our model learns the principles of protein-ligand interactions by independently extracting meaningful representations from both small molecules and proteins in a self-supervised manner (Figure 1). To do so, it learns to contrast interacting against non-interacting protein and ligand pairs in a high-dimensional interaction map via a supervised contrastive learning objective.</span></p><p class="c2"><span class="c0">Our model operates on molecule SMILES and protein sequences, which allows us to tap into vast amounts of protein-ligand bioactivity data for training, operate on structurally unresolved protein targets and achieve a high degree of generalization across the molecule and protein space.</span></p><p class="c2"><span class="c0">To obtain high-quality data for training, we have implemented a thorough ETL data pipeline and created a gold-standard dataset of over 80million protein-ligand activity datapoints from PubChem, ChEMBL and BindingDB databases.</span></p><p class="c2"><span class="c0">In its standard HitID operating mode, the model treats molecules and proteins independently, and the cosine distance in the high-dimensional co-embedding space serves to identify hit-candidates for any given protein sequence. This allows us to perform ultra-fast virtual screens, searching through &gt;10 billion ligands with less than a day of compute.</span></p><p class="c2 c11"><span class="c0"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 224.00px;"><img alt="" src="images/image1.png" style="width: 624.00px; height: 224.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2"><span class="c9 c10">Figure 1:</span><span class="c10 c14">&nbsp;Model architecture for protein-ligand activity prediction.</span></p><p class="c2 c11"><span class="c0"></span></p><p class="c2"><span class="c0">For hit list refinement as well as Hit2Lead scenarios, which is relevant for the ASAP Discovery challenge, the model can also operate in an interactive mode, where the protein module attends to the protein sequence of interest as well as a set of molecule representations, thus being able to extract targeted protein binding profiles relevant for a given set of ligands.</span></p><h2 class="c3" id="h.a4ibgjeb62pa"><span class="c12">Zero-shot prediction of protein-ligand potency</span></h2><p class="c2"><span class="c0">Initially, we used our model in interactive mode to co-embed the 1146 unique molecules and the two CoV proteins into the pre-trained interaction space.</span></p><p class="c2"><span class="c0">A UMAP project of the high-dimensional co-embedding space into 2D shows that the molecules fall into distinct clusters, mainly governed by the initial hits and their subsequent analogue expansion series (Figure 2). Ligands across and within clusters show pronounced organization by measured pIC50 values, suggesting our learned molecule embeddings represent meaningful biochemistry.</span></p><p class="c2"><span class="c0">Moreover, the extracted binding profiles for both CoV proteins align with the main molecule clusters, suggesting our model was able to extract binding information from the protein sequences relevant for the given molecule set.</span></p><p class="c2 c11"><span class="c0"></span></p><p class="c21"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 468.00px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 468.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c6"><span class="c9 c10">Figure 2:</span><span class="c10 c14">&nbsp;2D UMAP projection of the zero-shot embedding of the provided ligands and the two CoV-proteins in the high-dimensional interaction space. Panels are split column-wise by the proteins and row-wise by the test and train set molecules, with the latter colored according to their measured pIC50 values. Six binding profiles that the model extracted from the amino acid sequences of both MERS and SARS main protease are shown as big, dark red points.</span></p><p class="c2 c11"><span class="c0"></span></p><p class="c2"><span class="c7">Potency calibration</span></p><p class="c2"><span class="c0">Our model is trained on binarized interaction data with a contrastive learning objective. While this improves generalization capability and enables the identification of hits with high specificity in Hit Identification scenarios, the learned cosine distances on the interaction map are not strictly related to pX values which we need to predict for the ASAP challenge.</span></p><p class="c2"><span class="c0">To calibrate cosine similarities of protein-ligand interactions to the set of measured potency pX values, we trained a simple regression head on top of the co-embedding map in a four-fold cross-validation setup.</span></p><p class="c2"><span class="c14">Given only the cosine similarities of protein-ligand pairs and the protein identity (MERS or SARS), the calibrated co-embedding map distances predicted the given measured potency values of validation set molecules with </span><span class="c9">mean absolute errors of 0.67 for SARS-ligand interactions and 0.53 for MERS-ligand interactions </span><span class="c0">(Table 1).</span></p><p class="c2"><span class="c0">Importantly, the cross-validation procedure showed no signs of overfitting to the respective training sets.</span></p><p class="c2"><span class="c14">This suggests that our pre-trained protein-ligand activity model can robustly predict ligand binding affinities with high accuracy in a nearly zero shot fashion.</span></p><p class="c2 c11"><span class="c0"></span></p><h2 class="c3" id="h.makfmuxn0je8"><span class="c12">Learning from the data &amp; model fine-tuning</span></h2><p class="c2 c11"><span class="c0"></span></p><p class="c2"><span class="c0">We further explored how the model can use the given training data to improve potency predictions.</span></p><p class="c2"><span class="c0">First, we expanded the potency regression head to also take a ligand&rsquo;s embedding and the embedding of its closest protein binding profile into account, adding 2x256 inputs.</span></p><p class="c2"><span class="c0">Training on this expanded input indeed further improved the potency predictions.</span></p><p class="c2 c11"><span class="c0"></span></p><p class="c2"><span class="c14">Next, we </span><span class="c0">tested whether fine-tuning of our pre-trained model with the training set measurements could improve potency predictions.</span></p><p class="c2"><span class="c0">We thus allowed the protein module as well as the final embedding head of the molecule module to be fine-tuned with low learning rates during training of the potency regression head.</span></p><p class="c2"><span class="c0">Thus the learned molecule representations are frozen, while the protein module can learn to adjust its actions given the observed set of molecule representations, and the resulting embeddings can re-arrange in the co-embedding interaction space.</span></p><p class="c2"><span class="c0">Fine-tuning further improved the potency prediction performance, with a bigger potency regression head taking into account also the ligand and protein embeddings slightly winning over just calibrating cosine distances for pX predictions (Table 1).</span></p><p class="c2 c11"><span class="c0"></span></p><p class="c2"><span class="c0">Importantly, again the training and fine-tuning on additional data in a 4-fold cross validation setup showed no indication of overfitting the respective training sets, suggesting that the models pre-learned ligand and protein representations show robust generalization to unseen molecules and proteins.</span></p><p class="c2 c11"><span class="c0"></span></p><p class="c2"><span class="c9">Table 1:</span><span class="c0">&nbsp;Prediction results for different setups explored</span></p><p class="c2 c11"><span class="c0"></span></p><table class="c19"><tr class="c8"><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c7">Setup</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c7">Regression head input</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c7">Model fine-tuning</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c7">SARS potency predictions [MAE]</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c7">MERS potency predictions [MAE]</span></p></td></tr><tr class="c8"><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">Calibration only</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">cosine distances</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">-</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">0.67</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">0.53</span></p></td></tr><tr class="c8"><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">Learning on model representations</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">+ ligand embedding &amp; closest protein embedding</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">-</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">0.61</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">0.47</span></p></td></tr><tr class="c8"><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">Fine-tuning for potency prediction</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">cosine distances</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">protein module &amp; molecule embedding head</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">0.55</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">0.46</span></p></td></tr><tr class="c8"><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">Fine-tuning with representation learning</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">+ ligand embedding &amp; closest protein embedding</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">protein module &amp; molecule embedding head</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">0.53</span></p></td><td class="c1" colspan="1" rowspan="1"><p class="c5"><span class="c0">0.45</span></p></td></tr></table><p class="c2 c11"><span class="c0"></span></p></body></html>